<!doctype html>
<html lang="en">
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <title>Offerings</title>
</head>
<body>
    <div class="container">
        <!-- Top Section (Login/Sign Up) -->
        <div class="top-section">
            {% if not current_user.is_authenticated %}
                <a href="{{ url_for('login') }}" class="form-button">Login</a>
                <a href="{{ url_for('register') }}" class="form-button">Sign Up</a>
            {% else %}
                <p>Welcome back, {{ current_user.username }}!</p>
                <a href="{{ url_for('logout') }}" class="form-button">Logout</a>
            {% endif %}
        </div>

        <!-- Aesthetic Horizontal Line -->
        <hr class="styled-divider">

        <!-- Admin Section (Create Offering) -->
        {% if current_user.is_authenticated and current_user.role == 'admin' %}
            <div class="admin-section">
                <a href="{{ url_for('create_offering') }}" class="form-button">Create Offering</a>
            </div>
        {% endif %}

        <!-- Bottom Section (Available Offerings) -->
        <div class="bottom-section">
            <h2>Available Offerings</h2>
            <ul>
                {% for offering in offerings %}
                    <li class="offering-card">
                        <h3>{{ offering.lesson_type }} at {{ offering.location }}</h3>
                        <p class="time-slot">
                            {{ offering.start_time.strftime('%B %d') }}: {{ offering.start_time.strftime('%I:%M %p') }} to {{ offering.end_time.strftime('%I:%M %p') }}
                        </p>
                        <p class="spots-available">
                            Available spots: <span>{{ offering.available_spots }} / {{ offering.maximum_capacity }}</span>
                        </p>
                        
                        <!-- Check if the offering is available -->
                        {% if offering.available_spots == 0 %}
                            <p class="unavailable-text">Not Available</p>
                        {% else %}
                            {% if current_user.is_authenticated and current_user.role == 'customer' %}
                                {% if current_user in offering.attendees %}
                                    <p class="attending-text">You are already attending this offering.</p>
                                {% else %}
                                    <form action="{{ url_for('attend_offering', offering_id=offering.id) }}" method="POST">
                                        <button type="submit" class="form-button">Attend</button>
                                    </form>
                                {% endif %}
                            {% endif %}
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
        
        
    </div>
</body>
</html>
